(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    130220,       2824]
NotebookOptionsPosition[    129049,       2788]
NotebookOutlinePosition[    129424,       2805]
CellTagsIndexPosition[    129381,       2802]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["(*",
    FontSize->24], 
   StyleBox[" ",
    FontSize->18], 
   StyleBox[
    RowBox[{
    "Agent", " ", "Based", " ", "Macroeconomic", " ", "Model", " ", 
     "Simulation", " ", "Version", " ", "1.1", ".2", ".0"}],
    FontSize->24], 
   StyleBox[" ",
    FontSize->18], 
   StyleBox["*)",
    FontSize->24]}], 
  StyleBox["\[IndentingNewLine]",
   FontSize->24], 
  StyleBox["\[IndentingNewLine]",
   FontSize->24], 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Model", " ", "output", " ", "prints", " ", "at", " ", 
      RowBox[{"bottom", ".", " ", "To"}], " ", "run", " ", "a", " ", 
      "simulation", " ", "press", " ", "Cmd"}], "-", 
     RowBox[{"A", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"or", " ", "Ctrl"}], "-", 
        RowBox[{"A", " ", "on", " ", "Windows"}]}], ")"}], " ", "and", " ", 
      "hit", " ", "Shift"}], "-", 
     RowBox[{
      RowBox[{"Enter", ".", " ", "Clear"}], " ", "the", " ", "kernel", " ", 
      "between", " ", "runs", " ", "of", " ", "the", " ", 
      RowBox[{"simulation", "."}]}]}], " ", "*)"}],
   FontSize->14], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Update", " ", 
      RowBox[{"Log", ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", " ", "November"}], " ", "15"}]}]}], ",", " ", 
     RowBox[{"2018", ":", " ", 
      RowBox[{"v1", ".1", ".2"}], ":", " ", 
      RowBox[{
       RowBox[{"Feature", 
        RowBox[{"(", "s", ")"}], " ", "added"}], " ", "-", " ", "1"}], ":", 
      " ", 
      RowBox[{
      "Firms", " ", "update", " ", "prices", " ", "of", " ", "goods", " ", 
       "based", " ", "on", " ", "inventory", " ", "levels"}]}], ",", " ", 
     RowBox[{"2", ":", " ", 
      RowBox[{
      "Firms", " ", "update", " ", "their", " ", "expectations", " ", "of", 
       " ", "labor", " ", "prices", " ", "based", " ", "on", " ", "a", " ", 
       "moving", " ", "average", " ", "of", " ", "previous", " ", "wages"}]}],
      ",", " ", 
     RowBox[{"3", ":", " ", 
      RowBox[{
       RowBox[{
       "Added", " ", "more", " ", "tracked", " ", "metrics", " ", "about", 
        " ", "the", " ", "economy"}], "\[IndentingNewLine]", "-", " ", 
       RowBox[{"November", " ", "15"}]}]}], ",", " ", 
     RowBox[{"2018", ":", " ", 
      RowBox[{"v1", ".1", ".1", ".3"}], ":", " ", 
      RowBox[{
       RowBox[{
       "Fixed", " ", "issue", " ", "where", " ", "bank", " ", "balance", " ", 
        "sheets", " ", 
        RowBox[{"weren", "'"}], "t", " ", "updating", " ", "properly"}], 
       "\[IndentingNewLine]", "-", " ", 
       RowBox[{"November", " ", "14"}]}]}], ",", " ", 
     RowBox[{"2018", ":", " ", 
      RowBox[{"v1", ".1", ".1", ".2"}], ":", " ", 
      RowBox[{
       RowBox[{
       "Fixed", " ", "issue", " ", "where", " ", "reservation", " ", "wages", 
        " ", 
        RowBox[{"weren", "'"}], "t", " ", "updating", " ", "properly"}], 
       "\[IndentingNewLine]", "-", " ", 
       RowBox[{"November", " ", "14"}]}]}], ",", " ", 
     RowBox[{"2018", ":", " ", 
      RowBox[{"v1", ".1", ".1", ".1"}], ":", " ", 
      RowBox[{
      "Fixed", " ", "issue", " ", "where", " ", "cash", " ", "holdings", " ", 
       "are", " ", "going", " ", "negative", " ", "for", " ", 
       "households"}]}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "due", " ", "to", " ", "improper", " ", "MPC", " ", "calculations"}], 
       ")"}], "\[IndentingNewLine]", " ", "-", " ", 
      RowBox[{"November", " ", "14"}]}], ",", " ", 
     RowBox[{"2018", ":", " ", 
      RowBox[{"v1", ".1", ".1"}], ":", " ", 
      RowBox[{
       RowBox[{"Feature", 
        RowBox[{"(", "s", ")"}], " ", "added"}], " ", "-", " ", 
       RowBox[{
       "Allowed", " ", "inventory", " ", "to", " ", "persist", " ", "through",
         " ", "time", " ", 
        RowBox[{"(", 
         RowBox[{"ref", ":", " ", "InventorySpoilage"}], ")"}]}], 
       "\[IndentingNewLine]", "-", " ", 
       RowBox[{"November", " ", "13"}]}]}], ",", " ", 
     RowBox[{"2018", ":", " ", 
      RowBox[{"v1", ".1", ".0", ".1"}], ":", " ", 
      RowBox[{
       RowBox[{
       "Fixed", " ", "issue", " ", "where", " ", "consumption", " ", "loop", 
        " ", 
        RowBox[{"wouldn", "'"}], "t", " ", "work", " ", "when", " ", "firm", 
        " ", "inventory", " ", "equals", " ", "zero"}], "\[IndentingNewLine]",
        "-", " ", 
       RowBox[{"December", " ", "01"}]}]}], ",", " ", 
     RowBox[{"2017", ":", " ", 
      RowBox[{"v1", ".1", ".0"}], ":", " ", 
      RowBox[{
       RowBox[{"Features", 
        RowBox[{"(", "2", ")"}], " ", "added"}], " ", "-", " ", 
       RowBox[{"A", " ", "risk"}], "-", 
       RowBox[{"free", " ", "rate", " ", "on", " ", "deposits", " ", 
        RowBox[{"(", 
         RowBox[{"Note", ":", " ", 
          RowBox[{"NOT", " ", "SF", " ", "consistent", " ", "ATM"}]}], 
         ")"}]}]}]}]}], "\[IndentingNewLine]", 
    StyleBox[
     RowBox[{"*", ")"}]]}],
   FontSize->14], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Open", " ", "Issues"}], "\[IndentingNewLine]", "-", " ", 
     RowBox[{"Convergence", " ", "issues"}]}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"-", " ", "Economy"}], " ", "just", " ", "generally", " ", 
      "nosedives"}], " ", "\[IndentingNewLine]", "-", " ", 
     RowBox[{"{", 
      RowBox[{"Broad", " ", "set", " ", "of", " ", "unknown", " ", "issues"}],
       "}"}]}]}], "\[IndentingNewLine]", " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"SET", " ", "CONSTANTS"}], " ", "*)"}],
   FontSize->18], "\[IndentingNewLine]", 
  StyleBox["\[IndentingNewLine]",
   FontSize->18], 
  RowBox[{"(*", " ", 
   RowBox[{"Exogeneous", " ", "parameters"}], " ", "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  RowBox[{
   RowBox[{
    RowBox[{"NumPeriods", " ", "=", " ", "30"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumFirms", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumHouseholds", " ", "=", " ", "1000"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumBanks", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Production", " ", "parameters"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cash", " ", "=", " ", "3000"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "cash", " ", "to", " ", "single", " ", "firm"}], 
     " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"InitialCapital", " ", "=", " ", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitialLabor", " ", "=", " ", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PriceCapital", " ", "=", " ", "20"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "rental", " ", "rate"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"PriceLabor", " ", "=", " ", "10"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "wage"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"PriceGood", " ", "=", " ", "5"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "price"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"ReturnsCapital", " ", "=", " ", "0.3"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Returns", " ", "to", " ", "capital", " ", 
      RowBox[{"(", 
       RowBox[{"Cobb", "-", "Douglass"}], ")"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"ReturnsLabor", " ", "=", " ", "0.85"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Returns", " ", "to", " ", "labor", " ", 
      RowBox[{"(", 
       RowBox[{"Cobb", "-", "Douglass"}], ")"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"TechLevel", " ", "=", " ", "18"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Tech", " ", "adjustment", " ", "factor", " ", 
      RowBox[{"(", 
       RowBox[{"Cobb", "-", "Douglass"}], ")"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"InventorySpoilage", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "What", " ", "percentage", " ", "of", " ", "the", " ", "inventory", " ", 
      "survives", " ", "between", " ", "periods"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"InventoryLevelTarget", " ", "=", " ", "100"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Inventory", " ", "levels", " ", "the", " ", "firm", " ", "are", " ", 
      "targeting", " ", "by", " ", "changing", " ", "prices"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PriceUpAdjustment", " ", "=", " ", "1.5"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "How", " ", "much", " ", "firms", " ", "increase", " ", "the", " ", 
      "price", " ", "up", " ", "by", " ", 
      RowBox[{"(", "percentage", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{"PriceDownAdjustment", " ", "=", " ", "0.75"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "How", " ", "much", " ", "firms", " ", "increase", " ", "the", " ", 
      "price", " ", "down", " ", "by", " ", 
      RowBox[{"(", "percentage", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{"PriceMinimum", " ", "=", "0.05"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "minimum", " ", "price", " ", "a", " ", "firm", " ", "will", 
      " ", "charge", " ", "for", " ", "a", " ", "good"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"CapitalRateResponsivenessWait", " ", "=", " ", "2"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "How", " ", "long", " ", "capital", " ", "demand", " ", "has", " ", "to",
       " ", "fall", " ", "before", " ", "price", " ", "changes", " ", 
      RowBox[{"(", 
       RowBox[{"how", " ", "sticky", " ", "the", " ", "price", " ", "is"}], 
       ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"CapitalRateResponsivenessAmount", " ", "=", " ", "2"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "How", " ", "much", " ", "price", " ", "declines", " ", "for", " ", 
      "capital"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"(*", " ", 
     RowBox[{"Household", " ", "parameters"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"MPC", " ", "=", " ", "1"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"Marginal", " ", "Propensity", " ", "to", " ", "Consume"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"WageAdjustUpWait", " ", "=", " ", "3"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "If", " ", "employed", " ", "for", " ", "more", " ", "than", " ", "n", 
       " ", "periods"}], ",", " ", 
      RowBox[{"increase", " ", "reservation", " ", "wage"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"WageAdjustDownWait", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "If", " ", "unemployed", " ", "for", " ", "more", " ", "than", " ", "n",
        " ", "periods"}], ",", " ", 
      RowBox[{"decrease", " ", "reservation", " ", 
       RowBox[{"wage", " ", "--"}], " ", "note", " ", "unemployment", " ", 
       "is", " ", "\"\<negative\>\"", " ", "employment"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"WageAdjustUpAmount", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "How", " ", "many", " ", "dollars", " ", "to", " ", "increase", " ", 
      "wage", " ", "demands"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"WageAdjustDownAmount", " ", "=", " ", 
     RowBox[{"-", "2"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "How", " ", "many", " ", "dollars", " ", "to", " ", "decrease", " ", 
      "wage", " ", "demands"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"WageMinimum", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Banking", " ", "parameters"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RiskFreeRate", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Rate", " ", "paid", " ", "on", " ", 
      RowBox[{"deposits", " ", "--"}], " ", "rates", " ", "other", " ", 
      "than", " ", "1", " ", "break", " ", "breaks", " ", "SF", " ", 
      "consistency", " ", 
      RowBox[{"(", 
       RowBox[{"in", " ", "current", " ", "version"}], ")"}]}], " ", 
     "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.71794399429068*^9, 3.717944088469034*^9}, {
   3.717944223527998*^9, 3.717944253937831*^9}, {3.717944303936685*^9, 
   3.71794431129891*^9}, {3.717944347357753*^9, 3.717944361413274*^9}, {
   3.7179444120161877`*^9, 3.717944412150543*^9}, {3.717944583873506*^9, 
   3.717944592041326*^9}, {3.717949867687737*^9, 3.717949891023344*^9}, {
   3.7179510846092176`*^9, 3.717951085240744*^9}, {3.718630396993235*^9, 
   3.718630448673751*^9}, {3.718631407418619*^9, 3.718631407794302*^9}, {
   3.718641271825782*^9, 3.71864127193719*^9}, 3.7186422040326433`*^9, {
   3.7186425319819527`*^9, 3.718642532597638*^9}, {3.718642601180498*^9, 
   3.718642606359727*^9}, {3.718642828801457*^9, 3.718642859887558*^9}, {
   3.7186428990822067`*^9, 3.718642899928515*^9}, {3.718644037715271*^9, 
   3.718644039402918*^9}, {3.719577578157029*^9, 3.7195775948126497`*^9}, {
   3.719578115090866*^9, 3.719578151110469*^9}, {3.7195787010670137`*^9, 
   3.7195787179805*^9}, {3.719584618539195*^9, 3.7195846416145887`*^9}, {
   3.7195851412128267`*^9, 3.7195851412986803`*^9}, {3.719585907605435*^9, 
   3.719585907649891*^9}, {3.719612516402871*^9, 3.7196125177678423`*^9}, {
   3.719615370357798*^9, 3.7196153704655867`*^9}, {3.719615673076496*^9, 
   3.7196156750578423`*^9}, {3.71966980429452*^9, 3.7196698057244787`*^9}, {
   3.719670202992259*^9, 3.71967020349294*^9}, {3.719670379572741*^9, 
   3.719670391938308*^9}, {3.7196734813136168`*^9, 3.7196734826469812`*^9}, {
   3.7196739673898573`*^9, 3.719673967691881*^9}, {3.719676094320876*^9, 
   3.719676095101349*^9}, {3.71967651219748*^9, 3.7196765498425503`*^9}, {
   3.7197678743652697`*^9, 3.719767875058134*^9}, {3.719769314415477*^9, 
   3.719769314551297*^9}, {3.719769354289682*^9, 3.7197693570312843`*^9}, {
   3.719769787945034*^9, 3.719769788997964*^9}, {3.7198424226505613`*^9, 
   3.7198424232254477`*^9}, {3.719842516358561*^9, 3.719842516862193*^9}, {
   3.721671614965464*^9, 3.721671615897925*^9}, {3.721672648282323*^9, 
   3.721672649042322*^9}, {3.721688386257423*^9, 3.721688413544979*^9}, {
   3.721688478805253*^9, 3.7216884788991337`*^9}, {3.721688525308195*^9, 
   3.721688525371729*^9}, {3.721689081869954*^9, 3.721689259056584*^9}, {
   3.721746226671247*^9, 3.721746227875567*^9}, {3.721746262883079*^9, 
   3.7217462634661713`*^9}, {3.7217475691218863`*^9, 3.72174756944788*^9}, {
   3.72175650190384*^9, 3.721756521054274*^9}, {3.721756568431013*^9, 
   3.721756575957942*^9}, {3.721757376555475*^9, 3.721757379672634*^9}, 
   3.751129334655457*^9, {3.751134820009266*^9, 3.7511348211278057`*^9}, {
   3.7511421118672857`*^9, 3.75114215832224*^9}, {3.751142539743451*^9, 
   3.751142543756797*^9}, {3.751143060377026*^9, 3.751143061001122*^9}, {
   3.751191749939351*^9, 3.751191769986239*^9}, {3.751191949946286*^9, 
   3.751191961231536*^9}, {3.751191996179538*^9, 3.751192022313645*^9}, {
   3.751198712412171*^9, 3.751198728210414*^9}, {3.75119881539188*^9, 
   3.751198958920781*^9}, {3.7511990681744947`*^9, 3.7511990684836082`*^9}, {
   3.751199203857231*^9, 3.751199204399419*^9}, {3.751200512899632*^9, 
   3.751200513249248*^9}, 3.7512005449069433`*^9, {3.7512013899738092`*^9, 
   3.7512013911211977`*^9}, {3.751201432907918*^9, 3.751201433026863*^9}, {
   3.7512022706606407`*^9, 3.751202271195256*^9}, {3.7512079343048363`*^9, 
   3.751208102669488*^9}, {3.751208650304101*^9, 3.751208651284514*^9}, {
   3.751208793121539*^9, 3.751208813170223*^9}, {3.751209793731719*^9, 
   3.75120979553926*^9}, {3.7512100055063963`*^9, 3.751210011465334*^9}, {
   3.75121005027693*^9, 3.7512100582267637`*^9}, {3.7512106281239357`*^9, 
   3.7512106288180857`*^9}, {3.7512107340370398`*^9, 
   3.7512107362288847`*^9}, {3.751215037878614*^9, 3.751215038683053*^9}, {
   3.7512150997681503`*^9, 3.751215208256255*^9}, {3.7512153614778643`*^9, 
   3.751215369004684*^9}, {3.7512158227167*^9, 3.751215827713153*^9}, 
   3.7512162318615303`*^9, {3.751226083567733*^9, 3.751226218952716*^9}, {
   3.751226272812599*^9, 3.751226322740945*^9}, {3.7512270010218*^9, 
   3.7512271250459423`*^9}, {3.751274548877439*^9, 3.751274549952642*^9}, {
   3.75127677028021*^9, 3.7512767703992662`*^9}, {3.751281290105465*^9, 
   3.7512812920713243`*^9}, {3.7512816117496443`*^9, 3.751281670569847*^9}, {
   3.751281890015777*^9, 3.751281890526842*^9}, {3.751282418911614*^9, 
   3.7512824200463133`*^9}, {3.751282774969186*^9, 3.751282788494993*^9}, {
   3.751284919645069*^9, 3.751284983444377*^9}, {3.751288219142024*^9, 
   3.751288255237506*^9}, {3.75129309947617*^9, 3.751293101184161*^9}, {
   3.7512931737808723`*^9, 3.751293176882594*^9}, {3.751293222598586*^9, 
   3.751293224587878*^9}, {3.751293277535836*^9, 3.7512932779576063`*^9}, {
   3.751293325745227*^9, 3.751293331455224*^9}, 3.751293496828471*^9, {
   3.751293759923572*^9, 3.751293767705326*^9}, {3.751293827293415*^9, 
   3.751293827763112*^9}, {3.7512938994311934`*^9, 3.7512938999892797`*^9}, {
   3.751294052452263*^9, 3.751294090291264*^9}, {3.751296869391094*^9, 
   3.751296901118514*^9}, {3.7512973169384403`*^9, 3.751297317401247*^9}, {
   3.751297419629757*^9, 3.751297533815522*^9}, {3.7512977013021307`*^9, 
   3.751297701738627*^9}, {3.751297792193149*^9, 3.751297799102291*^9}, {
   3.751297845444927*^9, 3.751297861721589*^9}, {3.7512982802871733`*^9, 
   3.751298281251438*^9}, {3.7512984402260323`*^9, 3.751298452080121*^9}, {
   3.751298486012403*^9, 3.751298489449153*^9}, {3.751299418470826*^9, 
   3.751299419290522*^9}, {3.7513002864124002`*^9, 3.751300301486014*^9}, {
   3.751300398520789*^9, 3.751300399037397*^9}, 3.751303658663485*^9, {
   3.7513038070217123`*^9, 3.7513038824047527`*^9}, {3.751311210641395*^9, 
   3.751311318895051*^9}, {3.75131256262245*^9, 3.7513127074835033`*^9}, {
   3.751313573413534*^9, 3.751313591516522*^9}, {3.751313809928421*^9, 
   3.751313810164344*^9}, {3.751316411768915*^9, 3.75131641183712*^9}, {
   3.751316638672286*^9, 3.751316641934848*^9}, {3.7513167778536453`*^9, 
   3.751316778066845*^9}, {3.7513182947410583`*^9, 3.7513182956023073`*^9}, {
   3.7513184106672373`*^9, 3.75131841347369*^9}, {3.751318535318961*^9, 
   3.75131853544281*^9}, {3.751318663451522*^9, 3.751318673818222*^9}, {
   3.751318917540299*^9, 3.751318917651371*^9}, {3.751319444049302*^9, 
   3.7513194802617483`*^9}, {3.7513195697523823`*^9, 3.751319570581873*^9}, {
   3.751320833696267*^9, 3.7513208399655046`*^9}, {3.751320949478347*^9, 
   3.7513209552451077`*^9}, {3.7513209942921867`*^9, 3.751321010907996*^9}, {
   3.751321508248806*^9, 3.751321508348065*^9}, {3.751324326463578*^9, 
   3.751324328629746*^9}, {3.751324425673048*^9, 3.7513244616747293`*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"PROGRAM", " ", "INITIALIZATION"}], " ", "*)"}],
  FontSize->18]], "Input",
 CellChangeTimes->{{3.719584479068018*^9, 3.7195844877094717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "Balance", " ", "Sheets", " ", "and", " ", "funtions", " ", 
    "to", " ", "print", " ", "them"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BalanceSheetBanks", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumBanks", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintBanks", " ", ":=", " ", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"BalanceSheetBanks", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Label\>\"", ",", "\"\<Cash\>\"", ",", "\"\<Liabilities\>\"", 
          ",", "\"\<Equity\>\"", ",", "\"\<Expected Capital Inflow\>\"", ",", 
          "\"\<Capital Ratio\>\""}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BalanceSheetFirms", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumFirms", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintFirms", " ", ":=", " ", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"BalanceSheetFirms", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Label\>\"", ",", "\"\<Cash\>\"", ",", "\"\<Liabilities\>\"", 
          ",", "\"\<Equity\>\"", ",", "\"\<Inventory\>\""}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BalanceSheetHouseholds", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumHouseholds", ",", "8"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintHouseholds", " ", ":=", " ", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"BalanceSheetHouseholds", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Label\>\"", ",", "\"\<Cash (Liquid)\>\"", ",", 
          "\"\<Cash (Deposits)\>\"", ",", "\"\<Equity\>\"", ",", 
          "\"\<Net Wealth\>\"", ",", "\"\<Reservation Wage\>\"", ",", 
          "\"\<Employed\>\"", ",", "\"\<Cumulative Employment\>\""}], "}"}]}],
        "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7179451691294813`*^9, 3.717945296566086*^9}, {
  3.7179453451595297`*^9, 3.7179453984626827`*^9}, {3.717945437793083*^9, 
  3.71794551528174*^9}, {3.719577542681609*^9, 3.719577575104726*^9}, {
  3.719677371104924*^9, 3.719677393438374*^9}, {3.719678049867468*^9, 
  3.7196780612245283`*^9}, {3.719678135743367*^9, 3.719678136093266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "Labels", " ", "for", " ", "the", " ", "Balance", " ", 
    "Sheets"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"BalanceSheetBanks", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NumBanks"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"BalanceSheetFirms", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"BalanceSheetHouseholds", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NumHouseholds"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7195774869468317`*^9, 3.7195775574849777`*^9}, {
  3.719584497584785*^9, 3.7195845025260067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Create", " ", "array", " ", "for", " ", "production"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductionMatrix", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumFirms", ",", "12"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintProduction", " ", ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"ProductionMatrix", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Label\>\"", ",", "\"\<Cash\>\"", ",", "\"\<Current Capital\>\"",
           ",", "\"\<Current Labor\>\"", ",", "\"\<Capital Target\>\"", ",", 
          "\"\<Labor Target\>\"", ",", "\"\<Revenue Target\>\"", ",", 
          "\"\<Cost Capital\>\"", ",", "\"\<Cost Labor\>\"", ",", 
          "\"\<Profit\>\"", ",", "\"\<Rental Rate\>\"", ",", 
          "\"\<Salary\>\""}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Set", " ", 
     RowBox[{"firm", "'"}], "s", " ", "initial", " ", "cash", " ", "in", " ", 
     "the", " ", "Production", " ", "Matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"BalanceSheetFirms", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "Cash"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.717946396936537*^9, 3.7179465654840727`*^9}, {
   3.717950190919945*^9, 3.717950202390128*^9}, {3.717950424982296*^9, 
   3.717950426102264*^9}, 3.7179505571046467`*^9, {3.718374863157374*^9, 
   3.718374874941793*^9}, {3.718374904958671*^9, 3.7183749242951202`*^9}, {
   3.718582941768252*^9, 3.718582949003408*^9}, {3.718583005612277*^9, 
   3.7185830058122063`*^9}, {3.7185839431826773`*^9, 3.718583945554573*^9}, {
   3.7195776061486597`*^9, 3.719577614512686*^9}, {3.719578972297678*^9, 
   3.71957897519742*^9}, {3.719584505801104*^9, 3.7195845101183243`*^9}, {
   3.719585575224289*^9, 3.7195855928924303`*^9}, {3.719585749942399*^9, 
   3.7195857631494303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Define", " ", "functions", " ", "for", " ", "Cobb"}], "-", 
    RowBox[{"Douglas", " ", "production", " ", "function"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CostLabor", "[", "Labor_", "]"}], " ", ":=", " ", 
     RowBox[{"PriceLabor", "*", "Labor"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CostCapital", "[", "Capital_", "]"}], ":=", " ", 
     RowBox[{"PriceCapital", "*", "Capital"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Revenue", "[", 
      RowBox[{"Capital_", ",", "Labor_"}], "]"}], " ", ":=", " ", 
     RowBox[{"TechLevel", "*", "PriceGood", "*", 
      RowBox[{"(", 
       RowBox[{"Capital", "^", "ReturnsCapital"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"Labor", "^", "ReturnsLabor"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Profits", "[", 
      RowBox[{"Capital_", ",", "Labor_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Revenue", "[", 
       RowBox[{"Capital", ",", "Labor"}], "]"}], " ", "-", " ", 
      RowBox[{"CostCapital", "[", "Capital", "]"}], "-", 
      RowBox[{"CostLabor", "[", "Labor", "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7179440910794563`*^9, 3.71794421527057*^9}, {
   3.717944259607407*^9, 3.717944260351413*^9}, {3.7179445336309032`*^9, 
   3.7179445761860247`*^9}, {3.7179500510450983`*^9, 3.717950137414229*^9}, 
   3.717951265180985*^9, 3.718643232145969*^9, {3.7195776188663483`*^9, 
   3.719577642237732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "an", " ", "array", " ", "to", " ", "hold", " ", "the", " ",
     "Revenue", " ", "from", " ", "the", " ", 
    RowBox[{"Firm", "'"}], "s", " ", "sale", " ", "of", " ", "goods"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RevenueMatrix", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumFirms", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintRevenue", " ", ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"RevenueMatrix", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Label\>\"", ",", "\"\<Cash\>\"", ",", "\"\<Output\>\"", ",", 
          "\"\<Inventory\>\"", ",", "\"\<Price\>\""}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PriceHistory", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"PriceGood", ",", 
       RowBox[{"{", 
        RowBox[{"NumPeriods", ",", "NumFirms"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7195845640813293`*^9, 3.7195845914964314`*^9}, {
  3.7195854765237093`*^9, 3.7195854773323317`*^9}, {3.751289305681836*^9, 
  3.751289332697032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "an", " ", "array", " ", "to", " ", "hold", " ", "the", " ",
     "macroeconomic", " ", "statistics"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MacroeconomicOutput", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumPeriods", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintMacroeconomicOutput", " ", ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"MacroeconomicOutput", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Period\>\"", ",", "\"\<Output\>\"", ",", "\"\<Nominal GDP\>\"", 
          ",", "\"\<Global Inventory\>\"", ",", "\"\<Consumption\>\"", ",", 
          "\"\<Unemployment Rate\>\""}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LaborOutput", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumPeriods", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintLaborOutput", " ", ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"LaborOutput", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Period\>\"", ",", "\"\<Employment\>\"", ",", 
          "\"\<Unemployment Rate\>\"", ",", "\"\<Avg. Reservation Wage\>\"", 
          ",", "\"\<Avg. Paid Wage\>\""}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BusinessOutput", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumPeriods", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintBusinessOutput", " ", ":=", 
     RowBox[{"Grid", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"BusinessOutput", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Period\>\"", ",", "\"\<Price\>\"", ",", 
          "\"\<Expected Average Profit\>\""}], "}"}]}], "]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FirmDistribution", " ", "=", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"NumPeriods", ",", "NumFirms"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.719584949830398*^9, 3.719584966727227*^9}, {
   3.719668919076736*^9, 3.7196689299981813`*^9}, {3.7196691876399927`*^9, 
   3.719669200174591*^9}, {3.719669449819023*^9, 3.719669449946732*^9}, {
   3.7196695539673223`*^9, 3.719669559406049*^9}, {3.7196696948030863`*^9, 
   3.719669695433214*^9}, {3.7217572853010902`*^9, 3.721757313302047*^9}, {
   3.7512857622765293`*^9, 3.7512857679621687`*^9}, {3.751288538982593*^9, 
   3.751288545979925*^9}, {3.7513117077790194`*^9, 3.75131173987223*^9}, {
   3.751314105729925*^9, 3.751314105736844*^9}, 3.751314150742738*^9, {
   3.751314265851172*^9, 3.7513144507954617`*^9}, {3.751314779679969*^9, 
   3.7513148135890427`*^9}, {3.7513220949905863`*^9, 3.75132209582942*^9}, {
   3.751322305541095*^9, 3.75132230810844*^9}, {3.75132234833451*^9, 
   3.751322359446653*^9}, {3.751322448001861*^9, 3.751322507254641*^9}, {
   3.751322553194213*^9, 3.751322553479439*^9}, {3.751322760074806*^9, 
   3.75132279351964*^9}, {3.7513229861480017`*^9, 3.751322996267338*^9}, {
   3.7513235351012783`*^9, 3.751323535435976*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"ECONOMIC", " ", "PROCESSES"}], " ", "*)"}],
  FontSize->18]], "Input",
 CellChangeTimes->{{3.7195845962860203`*^9, 3.719584613840873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProductionAllocation", " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "OptimizationMatrix", "}"}], ",", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Create", " ", "labels"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ProductionMatrix", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Add", " ", "the", " ", 
        RowBox[{"firm", "'"}], "s", " ", "cash", " ", "to", " ", "the", " ", 
        "production", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ProductionMatrix", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"BalanceSheetFirms", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Solve", " ", "CB", " ", "optimization"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"OptimizationMatrix", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "NumFirms"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptimizationMatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Maximize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Profits", "[", 
              RowBox[{"K", ",", "L"}], "]"}], ",", 
             RowBox[{"K", "\[GreaterEqual]", " ", "0"}], ",", 
             RowBox[{"L", "\[GreaterEqual]", " ", "0"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"CostCapital", "[", "K", "]"}], "+", 
               RowBox[{"CostLabor", "[", "L", "]"}]}], "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"K", ",", "L"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Set", " ", "initial", " ", "capital"}], ",", " ", 
        RowBox[{"initial", " ", "labor"}], ",", " ", 
        RowBox[{"capital", " ", "target"}], ",", " ", 
        RowBox[{"labor", " ", "target"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", "InitialCapital"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", "InitialLabor"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"Floor", "[", 
            RowBox[{"Last", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"OptimizationMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"Floor", "[", 
            RowBox[{"Last", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"OptimizationMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Calculate", " ", "revenue"}], ",", " ", "costs", ",", " ", 
        "profits"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "7", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"Revenue", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ProductionMatrix", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"ProductionMatrix", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "8", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"CostCapital", "[", 
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "9", "]"}], "]"}], " ", "=", 
           RowBox[{"CostLabor", "[", 
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "6", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "10", "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "7", "]"}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "8", "]"}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "9", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
          "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Calculate", " ", "rental", " ", "rate", " ", "of", " ", "capital", 
        " ", "and", " ", "salary", " ", "offers"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "11", "]"}], "]"}], " ", "=", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], " ", "\[Equal]", "0"}], ",", 
             "0", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "8", "]"}], "]"}], "/", 
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionMatrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "12", "]"}], "]"}], " ", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", "0", 
             ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "9", "]"}], "]"}], "/", 
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}]}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "ProductionMatrix", "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7179466158953943`*^9, 3.717946620328658*^9}, {
   3.717946711516873*^9, 3.717946846664076*^9}, {3.7179469343338547`*^9, 
   3.7179469669800386`*^9}, {3.717946998947818*^9, 3.717947012768062*^9}, {
   3.7179482693629093`*^9, 3.717948291270897*^9}, {3.7179483214323273`*^9, 
   3.717948325024132*^9}, {3.717948416884246*^9, 3.717948464098669*^9}, {
   3.717948593983034*^9, 3.717948635693803*^9}, {3.717948754446773*^9, 
   3.717948767226943*^9}, {3.717949895599938*^9, 3.717950030075585*^9}, {
   3.717950172383265*^9, 3.717950180263748*^9}, {3.7179502141068974`*^9, 
   3.717950474522129*^9}, {3.717950541990663*^9, 3.7179505436053123`*^9}, {
   3.71795058285669*^9, 3.717950587186521*^9}, {3.718374890431353*^9, 
   3.71837496777568*^9}, {3.7183750055794287`*^9, 3.718375120140051*^9}, {
   3.718375232661743*^9, 3.7183752998360023`*^9}, {3.718642889542026*^9, 
   3.718642890529854*^9}, {3.718643247182556*^9, 3.7186432701194067`*^9}, {
   3.718643692884671*^9, 3.718643703715292*^9}, {3.7186437722564783`*^9, 
   3.718643774445888*^9}, {3.718643922459031*^9, 3.718643983546233*^9}, {
   3.719578947768111*^9, 3.7195789687147923`*^9}, {3.719584737419435*^9, 
   3.719584739849217*^9}, {3.719585601296793*^9, 3.719585734350659*^9}, {
   3.719585772522648*^9, 3.719585788104706*^9}, {3.7195858202187862`*^9, 
   3.719585902379149*^9}, {3.7195859678818607`*^9, 3.7195859763765182`*^9}, {
   3.719586134476282*^9, 3.7195861951300077`*^9}, {3.719609331551691*^9, 
   3.7196093333328648`*^9}, {3.719609841841937*^9, 3.7196098426500072`*^9}, {
   3.719609923416992*^9, 3.71960992440874*^9}, {3.719839173423232*^9, 
   3.719839184016427*^9}, {3.719839538630315*^9, 3.71983961017412*^9}, {
   3.719840103812907*^9, 3.719840118532257*^9}, {3.719840442298861*^9, 
   3.7198404483617907`*^9}, {3.719840512295874*^9, 3.719840514029182*^9}, 
   3.719842052239977*^9, 3.721402826594399*^9, {3.72140393109114*^9, 
   3.7214039381596212`*^9}, {3.721424306540718*^9, 3.721424318212117*^9}, {
   3.72142493874751*^9, 3.7214249466806383`*^9}, {3.7214250862911167`*^9, 
   3.721425097713697*^9}, {3.721582769068388*^9, 3.721582777082838*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PurchaseCapital", ":=", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ProductionMatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"ProductionMatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"BalanceSheetFirms", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-=", " ", 
        RowBox[{
         RowBox[{"ProductionMatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "8", "]"}], "]"}]}]}], "}"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFsog2EAxvHhQkq7mGxE2DDlkCZjOa3RIkqsuNnMoQyrRZRIzmYsjRwy
Sk6TaEI0WcuNY7mguBARqWX7UmayhfA+38XTr56LP7emUVbry2Awosmgqanb
kLVLSVxj7+Pw4STDCAvuq0xwbjRxDaaZVbStStEG5PyFb8Hft1I37anJA1PU
Hd9Q4RL4ZRODXAdsyBc2hEJd3FwEZBXKYqAm350Kr3ccQvq3xubDhct4OcwN
KqkUE30urPVQntdtg4Hn80ewOGCowkC0i89pk19baqFzqlkDd+3KNljkq26H
emlhJ9yrZOngQVHV4DixiXs9DIcmc4xw/UO7BA3L1k14E8ncggrBGHuC+Fk9
woGxWl0qrEt/zYCNvRYx/PHflsAp6Z0KvnhX1NBpvm2D/BlVJ+RZjFoYEewz
DaO82lVYbr/agY4n3iHcf+o6g+9K2y30Ppsf6c6DjILM7CzOJFHV9xUNzQPH
fNjTwmXPWijJiUdJy6I2QplWor4sDDYvehKgkxIlwZzvfiHscVMiaNNkhsiJ
RoGC9h9jXyzH
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Firms", " ", "go", " ", "into", " ", "the", " ", "labor", " ", "market", 
    " ", "to", " ", "hire", " ", "workers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LaborSearch", " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "EmploymentLevel", ",", "FirmOrdering", ",", "TempFirmBalanceSheet", 
        ",", "FirmLookup", ",", " ", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "reservation", " ", "wages"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Set", " ", "initial", " ", "reservation", " ", "wages"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"CurrentPeriod", " ", "\[Equal]", " ", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", "PriceLabor"}]}],
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Workers", " ", "adjust", " ", "their", " ", "reservation", " ", 
            "wages"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "8", "]"}], "]"}], "\[GreaterEqual]", " ", 
             "WageAdjustUpWait"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}], "+=", "WageAdjustUpAmount"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"BalanceSheetHouseholds", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "8", "]"}], "]"}], "\[LessEqual]", " ", 
              "WageAdjustDownWait"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"BalanceSheetHouseholds", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "6", "]"}], "]"}], "+", 
                "WageAdjustDownAmount"}], ")"}], "\[GreaterEqual]", 
              "WageMinimum"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}], "+=", 
             "WageAdjustDownAmount"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumHouseholds"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Calculate", " ", "the", " ", "number", " ", "of", " ", "open", " ", 
         "positions", " ", "and", " ", "instantiate", " ", "a", " ", "matrix",
          " ", "to", " ", "represent", " ", "those", " ", "jobs"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"EmploymentLevel", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "6", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ",", 
          "NumHouseholds"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Sort", " ", 
         RowBox[{"firm", "'"}], "s", " ", "salary", " ", "offers", " ", "and",
          " ", "household", " ", "reservation", " ", 
         RowBox[{"wages", ":", " ", 
          RowBox[{"low", " ", "to", " ", "high"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ProductionMatrix", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"ProductionMatrix", ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "12", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BalanceSheetHouseholds", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"BalanceSheetHouseholds", ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Ordering", " ", "the", " ", "firms", " ", "is", " ", "a", " ", 
         "little", " ", "more", " ", "tricky"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"FirmOrdering", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "NumFirms"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Create", " ", "array"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirmOrdering", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"ProductionMatrix", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", " ", 
       
       RowBox[{"(*", " ", 
        RowBox[{"Populate", " ", "array"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TempFirmBalanceSheet", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "NumFirms"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", " ", 
        RowBox[{
        "Match", " ", "the", " ", "ordering", " ", "of", " ", "the", " ", 
         "firms", " ", "in", " ", "the", " ", "balance", " ", "sheet", " ", 
         "with", " ", "the", " ", "ordering", " ", "of", " ", "the", " ", 
         "firms", " ", "in", " ", "the", " ", "production", " ", "matrix"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "NumFirms"}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FirmLookup", " ", "=", " ", 
           RowBox[{"FirmOrdering", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
            RowBox[{"j", "\[LessEqual]", " ", "NumFirms"}], ",", " ", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetFirms", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
               "FirmLookup"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"TempFirmBalanceSheet", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", 
                RowBox[{"BalanceSheetFirms", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"BalanceSheetFirms", " ", "=", " ", "TempFirmBalanceSheet"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"Hire", " ", "Labor"}],
         FontSize->16], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", "\[LessEqual]", " ", "EmploymentLevel"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", " ", "Salary", " ", "Offer"}], " ", ">", " ", 
              RowBox[{"Reservation", " ", "Wage"}]}], " ", "&"}], " ", "Firm",
             " ", "has", " ", "cash", " ", "on", " ", "hand", " ", "to", " ", 
            "pay", " ", "the", " ", "wage"}], ",", " ", 
           RowBox[{"&", " ", "the", " ", "firm", " ", 
            RowBox[{"hasn", "'"}], "t", " ", "met", " ", 
            RowBox[{"it", "'"}], "s", " ", "labor", " ", "target"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"BalanceSheetHouseholds", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}], " ", "\[LessEqual]", " ", 
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "12", "]"}], "]"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", 
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "12", "]"}], "]"}]}], ")"}], " ", "&&", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], " ", "<", " ", 
              RowBox[{
               RowBox[{"ProductionMatrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], ")"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+=", " ", 
             RowBox[{
              RowBox[{"ProductionMatrix", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "12", "]"}], "]"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Add", " ", "cash", " ", "to", " ", "household", " ", "based", 
              " ", "off", " ", "cost", " ", "of", " ", "labor"}], " ", "*)"}],
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetFirms", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "-=", 
             RowBox[{
              RowBox[{"ProductionMatrix", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "12", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{"Subtract", " ", "cash", " ", "from", " ", "firm"}], " ",
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ProductionMatrix", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "+=", " ", "1"}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Add", " ", "unit", " ", "of", " ", "labor", " ", "to", " ", 
              "firm"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "7", "]"}], "]"}], "=", "1"}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{"Update", " ", "employment", " ", "status"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "8", "]"}], "]"}], "<", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "8", "]"}], "]"}], "=", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "8", "]"}], "]"}], "+=", "1"}]}], "]"}], ";", 
            " ", 
            RowBox[{"(*", " ", 
             RowBox[{"Update", " ", "cumulative"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"i", "+=", "1"}], ";"}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"Go", " ", "to", " ", "next", " ", "house"}], " ", "*)"}],
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "+=", "1"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"If", " ", "not"}], ",", " ", 
              RowBox[{
              "households", " ", "search", " ", "for", " ", "the", " ", 
               "next", " ", "highest", " ", "salary", " ", "offer"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"j", ">", "NumFirms"}], ",", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ";", " ", 
               RowBox[{"i", "+=", "1"}]}]}], "]"}]}]}], "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "If", " ", "checked", " ", "all", " ", "firms", " ", "then", " ", 
            "go", " ", "to", " ", "next", " ", "house"}], " ", "*)"}], 
          "\[IndentingNewLine]", "]"}]}], " ", "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "not", " ", "employed", " ", "set", " ", "the", " ", 
          "cumulative", " ", "employment", " ", "to"}], " ", "-", "1"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"BalanceSheetHouseholds", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "7", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"BalanceSheetHouseholds", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "8", "]"}], "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"BalanceSheetHouseholds", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "8", "]"}], "]"}], "=", 
              RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"BalanceSheetHouseholds", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "8", "]"}], "]"}], "-=", "1"}]}], "]"}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumHouseholds"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Resort", " ", "by", " ", "label"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ProductionMatrix", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"ProductionMatrix", ",", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BalanceSheetHouseholds", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"BalanceSheetHouseholds", ",", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BalanceSheetFirms", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"BalanceSheetFirms", ",", " ", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"BalanceSheetHouseholds", ",", "ProductionMatrix"}], 
        "}"}]}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7183745159825*^9, 3.718374551580193*^9}, {
   3.718374593836776*^9, 3.718374691027012*^9}, {3.718374729392531*^9, 
   3.718374731208522*^9}, {3.718374761761531*^9, 3.718374784906139*^9}, {
   3.718375322560668*^9, 3.718375357149413*^9}, {3.7183753878567133`*^9, 
   3.718375449560713*^9}, {3.718375605966928*^9, 3.718375627287738*^9}, {
   3.718375668911075*^9, 3.718375714571542*^9}, {3.718375847602469*^9, 
   3.7183758553032017`*^9}, {3.7183759931789637`*^9, 3.718376153337967*^9}, {
   3.718380282502351*^9, 3.718380357837769*^9}, {3.718381027976972*^9, 
   3.718381092993536*^9}, {3.718542060251136*^9, 3.71854206235155*^9}, {
   3.718542123622703*^9, 3.7185421875808*^9}, {3.718542274965662*^9, 
   3.71854228331278*^9}, {3.7185423143209887`*^9, 3.718542392574184*^9}, {
   3.718550579009246*^9, 3.7185506066290817`*^9}, {3.7185507219556313`*^9, 
   3.718550804186116*^9}, {3.718550909832465*^9, 3.718550912441387*^9}, {
   3.7185517325060253`*^9, 3.718551740386958*^9}, {3.718551972235003*^9, 
   3.718552023413013*^9}, {3.7185520617033*^9, 3.7185520775322247`*^9}, {
   3.718552374852244*^9, 3.718552405186634*^9}, {3.7185525188336077`*^9, 
   3.718552555206195*^9}, {3.718552620772233*^9, 3.718552760033828*^9}, {
   3.7185528921865387`*^9, 3.718552990621867*^9}, {3.718553113090077*^9, 
   3.718553155965054*^9}, {3.71855330188659*^9, 3.718553349402828*^9}, {
   3.7185534345896177`*^9, 3.7185536521106367`*^9}, 3.71858395457551*^9, {
   3.718629769073097*^9, 3.718629769215682*^9}, {3.718644252124196*^9, 
   3.718644253652528*^9}, {3.718644337371304*^9, 3.718644403906726*^9}, {
   3.7196146497519627`*^9, 3.7196146529616013`*^9}, {3.719674326219679*^9, 
   3.719674335292099*^9}, {3.719677539788525*^9, 3.7196776276295958`*^9}, 
   3.719677727156659*^9, {3.7196780890529203`*^9, 3.719678103971518*^9}, {
   3.719678618386764*^9, 3.7196786451281023`*^9}, {3.71967870150723*^9, 
   3.719678737594801*^9}, {3.7196789191582527`*^9, 3.7196789656393642`*^9}, {
   3.7196790141370783`*^9, 3.719679042384243*^9}, {3.719679135294908*^9, 
   3.719679151213648*^9}, {3.719680081969729*^9, 3.719680186461173*^9}, {
   3.7196805779600897`*^9, 3.71968069232023*^9}, {3.719680725562028*^9, 
   3.719680750595066*^9}, {3.7196823270896063`*^9, 3.719682334237289*^9}, {
   3.719683970447329*^9, 3.7196841103426743`*^9}, {3.719684169869919*^9, 
   3.719684296959943*^9}, {3.719685030069563*^9, 3.719685092036818*^9}, {
   3.719685438327133*^9, 3.719685441245913*^9}, 3.719685563703906*^9, {
   3.7197034142909317`*^9, 3.719703480455236*^9}, 3.719704437852277*^9, 
   3.719704559056281*^9, {3.719767836514072*^9, 3.7197678674281178`*^9}, {
   3.719768183522615*^9, 3.7197681875465393`*^9}, {3.719768374549919*^9, 
   3.719768374733368*^9}, {3.719769123993286*^9, 3.719769130942251*^9}, {
   3.71976973814579*^9, 3.7197697841132927`*^9}, {3.719769894562965*^9, 
   3.719769895761547*^9}, {3.719770012010594*^9, 3.719770158664197*^9}, {
   3.7197702330891953`*^9, 3.7197702528193493`*^9}, {3.719770770216715*^9, 
   3.719770774094572*^9}, {3.719771338514491*^9, 3.719771447170513*^9}, {
   3.7197715290813427`*^9, 3.7197715377909727`*^9}, {3.719771586410627*^9, 
   3.719771586512452*^9}, {3.7197717230242777`*^9, 3.719771728173908*^9}, {
   3.719771793609376*^9, 3.719771796262844*^9}, {3.719771843750071*^9, 
   3.7197718517549*^9}, {3.719837696247856*^9, 3.71983776492225*^9}, {
   3.719837832166271*^9, 3.7198378869860563`*^9}, {3.719838345667171*^9, 
   3.7198383616746073`*^9}, {3.719838532348617*^9, 3.7198385960380993`*^9}, {
   3.7198388389629*^9, 3.7198388453416777`*^9}, {3.719840399529994*^9, 
   3.7198404025765867`*^9}, {3.719840582606629*^9, 3.7198406010455008`*^9}, 
   3.72140839058359*^9, {3.721425127558797*^9, 3.721425129812899*^9}, {
   3.7214253087025337`*^9, 3.721425309221672*^9}, {3.721425409747836*^9, 
   3.721425415298785*^9}, {3.7215825721881933`*^9, 3.721582587490542*^9}, {
   3.721582885005868*^9, 3.721582887446788*^9}, {3.72158292560026*^9, 
   3.721582925959021*^9}, {3.721583059858626*^9, 3.721583150583631*^9}, {
   3.721583458978386*^9, 3.721583486028133*^9}, {3.721583527086834*^9, 
   3.7215835318083353`*^9}, 3.721583592148292*^9, {3.7215845579413958`*^9, 
   3.721584558635109*^9}, {3.721584627975206*^9, 3.721584686215803*^9}, {
   3.7215873610254383`*^9, 3.721587366544425*^9}, {3.721587522829465*^9, 
   3.721587523517774*^9}, {3.721587789018567*^9, 3.721587789712257*^9}, {
   3.72158790910084*^9, 3.721587909827573*^9}, {3.72166529633538*^9, 
   3.721665436703272*^9}, {3.721666038724015*^9, 3.7216660506924667`*^9}, {
   3.721667086991542*^9, 3.721667097014264*^9}, {3.721667127814702*^9, 
   3.721667178086391*^9}, {3.721667261757633*^9, 3.7216674154223957`*^9}, {
   3.721667479533646*^9, 3.72166752868251*^9}, {3.721667775908257*^9, 
   3.72166778684142*^9}, {3.721670353144512*^9, 3.721670354977688*^9}, {
   3.721670584807831*^9, 3.721670633722721*^9}, {3.721670671720603*^9, 
   3.7216707130949373`*^9}, {3.721670767280883*^9, 3.7216707730611258`*^9}, {
   3.721670812975032*^9, 3.721670823293168*^9}, {3.7216708774192047`*^9, 
   3.721670881103674*^9}, {3.72167099832014*^9, 3.721671007294938*^9}, 
   3.721671077609392*^9, {3.721671113648929*^9, 3.7216711140397787`*^9}, {
   3.721671642345117*^9, 3.7216716577988377`*^9}, 3.7216727503148317`*^9, {
   3.721689941104456*^9, 3.721689979647509*^9}, {3.751142312272406*^9, 
   3.751142324310915*^9}, {3.751144501228258*^9, 3.751144503000758*^9}, {
   3.751205473753034*^9, 3.751205488271661*^9}, {3.751216154637896*^9, 
   3.751216156916029*^9}, {3.751226253416657*^9, 3.751226266933798*^9}, {
   3.751226397645997*^9, 3.7512264555019197`*^9}, {3.751226487007827*^9, 
   3.751226564547278*^9}, {3.751226802605958*^9, 3.7512268655540247`*^9}, {
   3.751279964359823*^9, 3.7512800044637957`*^9}, {3.751294580963965*^9, 
   3.751294583344301*^9}, {3.7512961564064293`*^9, 3.7512961956050243`*^9}, {
   3.751296263128044*^9, 3.751296264207452*^9}, {3.751323131841011*^9, 
   3.751323179585128*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Carry", " ", "out", " ", "Production"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"FirmsProduce", ":=", " ", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RevenueMatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "i"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Create", " ", "Labels"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"RevenueMatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"Floor", "[", 
         RowBox[{"TechLevel", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "^", "ReturnsCapital"}], ")"}], 
          "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ProductionMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "^", "ReturnsLabor"}], ")"}]}], 
         "]"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"RevenueMatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], " ", "+=", "  ", 
       RowBox[{
        RowBox[{"RevenueMatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Current", " ", "inventory", " ", "equals", " ", "previous", " ", 
        "inventory"}], " ", "+", " ", 
       RowBox[{"new", " ", "output"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.718583584993389*^9, 3.718583604787263*^9}, {
   3.7185837016698847`*^9, 3.718583835131504*^9}, {3.71858396408292*^9, 
   3.718583984565156*^9}, {3.71858412247762*^9, 3.718584146638505*^9}, 
   3.718584471030772*^9, {3.718584584613415*^9, 3.71858460426338*^9}, {
   3.7185847153273973`*^9, 3.7185847819592524`*^9}, {3.7185848221074667`*^9, 
   3.718584827552746*^9}, {3.7185848854252863`*^9, 3.7185848951452713`*^9}, {
   3.718585043695677*^9, 3.718585069429428*^9}, 3.718585451795081*^9, 
   3.7185854888884983`*^9, {3.718585644863866*^9, 3.718585647982396*^9}, {
   3.71862921576858*^9, 3.718629217616243*^9}, 3.718629457240563*^9, {
   3.718629491864091*^9, 3.718629494290801*^9}, {3.718629615127817*^9, 
   3.71862962006496*^9}, 3.7186309093255568`*^9, {3.718631785669031*^9, 
   3.7186317967088537`*^9}, {3.718631846808401*^9, 3.718631865007606*^9}, {
   3.7186326130466747`*^9, 3.718632625135173*^9}, {3.71863267507187*^9, 
   3.718632679016384*^9}, {3.719584542260572*^9, 3.719584555511512*^9}, {
   3.71958546056073*^9, 3.719585463477339*^9}, {3.7195855138460503`*^9, 
   3.71958552950834*^9}, {3.751191508805256*^9, 3.75119153753895*^9}, {
   3.751196565736478*^9, 3.751196580222211*^9}, {3.751197632675815*^9, 
   3.7511976682686996`*^9}, {3.751198314830825*^9, 3.751198324166695*^9}, {
   3.751300676910265*^9, 3.751300720452612*^9}, {3.751301163060533*^9, 
   3.751301167793314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Consumers", " ", "and", " ", "firms", " ", "go", " ", "to", " ", "the", 
    " ", "market"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ConsumptionMarket", " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CashDeposits", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ConsumptionTracker", " ", "=", " ", "0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Calculate", " ", "the", " ", 
          RowBox[{"Consumer", "'"}], "s", " ", "Budgets"}], " ", "-", " ", 
         RowBox[{"Households", " ", "deposit", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "MPC"}], ")"}], " ", "in", " ", "the", " ", 
          "Bank"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "7", "]"}], "]"}], "==", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CashDeposits", " ", "=", " ", "0"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"CashDeposits", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "MPC"}], ")"}], "*", 
                RowBox[{
                 RowBox[{"BalanceSheetHouseholds", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", "+=", " ", 
               "CashDeposits"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-=", " ", 
               "CashDeposits"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetBanks", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "+=", " ", 
               "CashDeposits"}], ";", 
              RowBox[{"(*", " ", 
               RowBox[{"Increase", " ", 
                RowBox[{"bank", "'"}], "s", " ", "cash"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetBanks", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", "+=", " ", 
               "CashDeposits"}], ";"}], "}"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"And", " ", 
             RowBox[{"bank", "'"}], "s", " ", "liabilities"}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumHouseholds"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Compute", " ", "the", " ", "Price", " ", "that", " ", "a", " ", 
         "Firm", " ", "charges", " ", 
         RowBox[{"(", 
          RowBox[{"in", " ", "the", " ", "first", " ", "period"}], ")"}]}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"RevenueMatrix", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"PriceHistory", "[", 
            RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Rank", " ", "firms", " ", "by", " ", "cheapest", " ", "to", " ", 
         "most", " ", "expensive"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RevenueMatrix", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"RevenueMatrix", ",", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Index", " ", "tracks", " ", "current", " ", "household"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Index", " ", "tracks", " ", "current", " ", "firm"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", " ", "<", "NumHouseholds"}], ",", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Check", " ", "if", " ", "household", " ", "can", " ", "afford", 
            " ", "to", " ", "buy", " ", "at", " ", 
            RowBox[{"all", ":", " ", 
             RowBox[{
              RowBox[{"cash", " ", "on", " ", "hand"}], " ", "<", " ", 
              RowBox[{"cheapest", " ", "price"}]}]}]}], " ", "=", 
           RowBox[{">", " ", 
            RowBox[{"go", " ", "to", " ", "next", " ", "house"}]}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "<", 
             RowBox[{"Min", "[", 
              RowBox[{"RevenueMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "5"}], "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "+=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", " ", "Cash", " ", "on", " ", "Hand"}], " ", ">", 
              " ", 
              RowBox[{"Price", " ", "of", " ", "the", " ", "Good"}]}], " ", 
             "&"}], " ", "Inventories", " ", "are", " ", "greater", " ", 
            "than", " ", "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "\[GreaterEqual]", " ", 
               RowBox[{
                RowBox[{"RevenueMatrix", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"RevenueMatrix", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ">", " ", "0"}], ")"}]}], ",",
             " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"BalanceSheetHouseholds", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-=", " ", 
               RowBox[{
                RowBox[{"RevenueMatrix", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"Subtract", " ", "cash", " ", "to", " ", "household"}],
                " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"RevenueMatrix", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "+=", 
               RowBox[{
                RowBox[{"RevenueMatrix", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], " ", ",", 
              RowBox[{"(*", " ", 
               RowBox[{"Add", " ", "cash", " ", "to", " ", "firm"}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"RevenueMatrix", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], "-=", " ", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ConsumptionTracker", "+=", "1"}]}], "}"}]}], "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"If", " ", 
             RowBox[{"firm", "'"}], "s", " ", "inventory", " ", "equals", " ",
              "zero"}], ",", " ", 
            RowBox[{"go", " ", "to", " ", "next", " ", "firm"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"RevenueMatrix", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], " ", "&&", 
             RowBox[{"j", "<", "NumFirms"}]}], " ", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"j", "+=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "If", " ", "all", " ", "firms", " ", "out", " ", "of", " ", 
            "inventory", " ", "exit", " ", "search"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "RevenueMatrix", "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"If", " ", "house", " ", 
             RowBox[{"can", "'"}], "t", " ", "afford", " ", "to", " ", "buy", 
             " ", "more"}], ",", " ", 
            RowBox[{"go", " ", "to", " ", "next", " ", "house"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetHouseholds", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", 
             RowBox[{
              RowBox[{"RevenueMatrix", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"i", "+=", "1"}], ";"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Resort", " ", "Firms", " ", "by", " ", "Label"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RevenueMatrix", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"RevenueMatrix", ",", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "BalanceSheetHouseholds", ",", "RevenueMatrix", ",", 
         "ConsumptionTracker", ",", " ", "GDPtracker"}], "}"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.718629744266913*^9, 3.7186297988327723`*^9}, {
   3.718630291920952*^9, 3.718630351419235*^9}, {3.718630476690187*^9, 
   3.718630486943981*^9}, {3.7186306144751997`*^9, 3.71863061580357*^9}, 
   3.718630775800098*^9, {3.718630867667532*^9, 3.7186309035485907`*^9}, {
   3.718631140511936*^9, 3.7186311760279284`*^9}, {3.718631364866543*^9, 
   3.718631404674445*^9}, {3.718631499009592*^9, 3.7186315360539837`*^9}, {
   3.7186315866640778`*^9, 3.718631603193583*^9}, {3.718631740161047*^9, 
   3.718631742919567*^9}, {3.718631809853241*^9, 3.7186318398164673`*^9}, {
   3.718631974360861*^9, 3.7186320296166162`*^9}, {3.718632221599736*^9, 
   3.7186322829687977`*^9}, {3.718632558579522*^9, 3.718632606599419*^9}, {
   3.718632656816593*^9, 3.7186326714565573`*^9}, {3.718632729472816*^9, 
   3.718632870247891*^9}, {3.718632902171369*^9, 3.718632912532522*^9}, {
   3.71863294355315*^9, 3.71863294527847*^9}, {3.718633033446438*^9, 
   3.718633090734206*^9}, {3.7186402829409637`*^9, 3.7186403235270367`*^9}, {
   3.718640416730957*^9, 3.718640422178801*^9}, {3.71864048809569*^9, 
   3.718640502630679*^9}, {3.7186413252802753`*^9, 3.7186413594484453`*^9}, {
   3.7186415084109707`*^9, 3.718641542684114*^9}, {3.718641888023819*^9, 
   3.7186418933992357`*^9}, {3.718644749156077*^9, 3.718644766044557*^9}, {
   3.718644817753459*^9, 3.718644824055146*^9}, {3.718644896652851*^9, 
   3.718644901996086*^9}, {3.718644944806971*^9, 3.718645051880134*^9}, {
   3.7187297827877083`*^9, 3.7187300123929243`*^9}, 3.71873041970708*^9, {
   3.718730547096277*^9, 3.7187305471660347`*^9}, {3.7187306684734287`*^9, 
   3.71873075861841*^9}, {3.7187308663807707`*^9, 3.7187310322119427`*^9}, {
   3.718731169243579*^9, 3.7187312005474777`*^9}, {3.718731248529208*^9, 
   3.71873133684862*^9}, {3.7187314169886637`*^9, 3.718731418817745*^9}, {
   3.718799258952239*^9, 3.71879928234068*^9}, {3.718799528808938*^9, 
   3.718799533775622*^9}, {3.718802803147366*^9, 3.718803080960267*^9}, {
   3.7188031993546667`*^9, 3.718803260681114*^9}, {3.718803310990778*^9, 
   3.7188033337092752`*^9}, {3.7188035262885637`*^9, 3.71880354064003*^9}, {
   3.7188045365177593`*^9, 3.718804564781309*^9}, {3.718804773498138*^9, 
   3.718804807281608*^9}, {3.718804975903319*^9, 3.718804989407805*^9}, {
   3.7188055388312397`*^9, 3.718805578837245*^9}, {3.718805709639289*^9, 
   3.718805737971498*^9}, 3.718805777817301*^9, {3.718805829667045*^9, 
   3.718805866316473*^9}, {3.7188063847877693`*^9, 3.7188064931637363`*^9}, {
   3.718806659288864*^9, 3.718806669191657*^9}, {3.718806734763096*^9, 
   3.7188067721513*^9}, {3.718807033788859*^9, 3.718807042363447*^9}, {
   3.718807126407378*^9, 3.718807126948585*^9}, {3.718807374371776*^9, 
   3.718807376656829*^9}, {3.718807446403985*^9, 3.718807455980578*^9}, {
   3.718807667257968*^9, 3.7188076672797213`*^9}, {3.718807717301649*^9, 
   3.718807734316523*^9}, {3.719163239451449*^9, 3.7191632505349197`*^9}, {
   3.719576471925076*^9, 3.719576513894698*^9}, {3.719576551094735*^9, 
   3.719576657187949*^9}, {3.71957670146242*^9, 3.719576758909411*^9}, {
   3.71957679349942*^9, 3.7195768021859827`*^9}, {3.719576953122645*^9, 
   3.719576954664222*^9}, {3.7195769921422987`*^9, 3.719576994336247*^9}, {
   3.719577095531972*^9, 3.719577136973569*^9}, {3.7195772102419777`*^9, 
   3.71957736663197*^9}, {3.719670270270998*^9, 3.719670307164649*^9}, 
   3.7196703463459053`*^9, {3.7196716516879683`*^9, 3.7196716524749947`*^9}, {
   3.719674459172864*^9, 3.7196744592353086`*^9}, 3.719674534088146*^9, 
   3.719685432262557*^9, {3.7198386102871933`*^9, 3.719838637261484*^9}, {
   3.7198455445032997`*^9, 3.719845550982329*^9}, {3.7214027574499826`*^9, 
   3.72140275826507*^9}, {3.721424182081319*^9, 3.721424185265491*^9}, {
   3.7215831702182503`*^9, 3.72158317133628*^9}, {3.751134242558174*^9, 
   3.751134291175517*^9}, {3.751134354559394*^9, 3.751134379041354*^9}, {
   3.7511344292429*^9, 3.75113443891647*^9}, {3.751134667150442*^9, 
   3.751134669276203*^9}, {3.751134728603188*^9, 3.751134753245255*^9}, {
   3.751134871326665*^9, 3.751134876502309*^9}, {3.75113546670994*^9, 
   3.751135480614132*^9}, {3.7511369913205013`*^9, 3.7511370151041822`*^9}, {
   3.751137231759224*^9, 3.751137236439032*^9}, {3.751141081011222*^9, 
   3.75114118835537*^9}, {3.7511413123387947`*^9, 3.751141318018854*^9}, {
   3.7511414183526917`*^9, 3.7511414377764893`*^9}, {3.751141485631757*^9, 
   3.75114148645371*^9}, {3.7511416334063*^9, 3.751141662275688*^9}, {
   3.751141724770948*^9, 3.751141791322405*^9}, {3.751141876797377*^9, 
   3.751141973749443*^9}, {3.751142019102516*^9, 3.7511420400693693`*^9}, {
   3.751142076450445*^9, 3.751142079633234*^9}, {3.7511422697339373`*^9, 
   3.751142293029442*^9}, {3.751144631151643*^9, 3.751144642597967*^9}, {
   3.7512020034037247`*^9, 3.751202046459908*^9}, {3.751202329142468*^9, 
   3.751202400824595*^9}, {3.7512025717900963`*^9, 3.751202596285679*^9}, {
   3.751205558473289*^9, 3.7512055784969807`*^9}, {3.7512056691969967`*^9, 
   3.751205669660747*^9}, {3.751209469093535*^9, 3.751209498773436*^9}, {
   3.7512098287892942`*^9, 3.7512098309252787`*^9}, {3.7512102013457327`*^9, 
   3.7512102047758503`*^9}, {3.751210289202742*^9, 3.751210372490575*^9}, {
   3.751214522759901*^9, 3.751214523247077*^9}, {3.751214983744326*^9, 
   3.751215020701688*^9}, {3.751275138948498*^9, 3.751275152060947*^9}, {
   3.751275202701621*^9, 3.751275206948669*^9}, 3.751278756524823*^9, {
   3.751278937574731*^9, 3.751278997836504*^9}, {3.751279093497035*^9, 
   3.751279105518198*^9}, {3.7512798161494637`*^9, 3.7512798191064796`*^9}, {
   3.751280272940094*^9, 3.751280348912775*^9}, {3.751280578000607*^9, 
   3.751280588270752*^9}, {3.751288991161736*^9, 3.7512889959303083`*^9}, {
   3.75128908162908*^9, 3.751289108188875*^9}, {3.751289144109886*^9, 
   3.751289146425129*^9}, {3.7512918362263193`*^9, 3.751291853441204*^9}, {
   3.7512919005395317`*^9, 3.751291901490822*^9}, {3.7512921012096243`*^9, 
   3.751292104528928*^9}, {3.7513213516775*^9, 3.751321379125403*^9}, {
   3.751321413584298*^9, 3.75132142627116*^9}, {3.751321702398452*^9, 
   3.751321713206132*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bookkeeping", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RevenueSummary", ",", "Employment"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Push", " ", 
       RowBox[{"Firm", "'"}], "s", " ", "Cash", " ", "and", " ", "Inventory", 
       " ", "to", " ", "their", " ", "Balance", " ", "Sheet", " ", "for", " ",
        "the", " ", "next", " ", "period"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"BalanceSheetFirms", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "+=", " ", 
          RowBox[{
           RowBox[{"RevenueMatrix", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"BalanceSheetFirms", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"RevenueMatrix", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"RevenueSummary", " ", "=", " ", 
       RowBox[{"Total", "[", "RevenueMatrix", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Employment", " ", "=", " ", 
       RowBox[{
        RowBox[{"Total", "[", "ProductionMatrix", "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Firms", " ", "adjust", " ", "their", " ", "salary", " ", "based", " ",
         "on", " ", "their", " ", "expectation", " ", "of", " ", "the", " ", 
        "price", " ", "of", " ", "labor"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"PriceLabor", " ", "=", " ", 
       RowBox[{
        RowBox[{"0.85", "*", "PriceLabor"}], " ", "+", " ", 
        RowBox[{"0.15", "*", " ", 
         RowBox[{"Mean", "[", 
          RowBox[{"BalanceSheetHouseholds", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "6"}], "]"}], "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Firms", " ", "adjust", " ", "the", " ", "price", " ", "of", " ", 
        "their", " ", "goods", " ", "to", " ", 
        RowBox[{"push", "/", "hold"}], " ", "back", " ", 
        RowBox[{"unsold", "/", "oversold"}], " ", "inventory"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Set", " ", "default", " ", "as", " ", "\"\<Markov\>\""}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"CurrentPeriod", " ", "\[NotEqual]", " ", "NumPeriods"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"PriceHistory", "[", 
              RowBox[{"[", 
               RowBox[{"CurrentPeriod", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"PriceHistory", "[", 
              RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Increase", " ", "with", " ", "low", " ", "inventory"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetFirms", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], " ", "<", " ", 
             "InventoryLevelTarget"}], " ", "&&", " ", 
            RowBox[{"CurrentPeriod", "\[NotEqual]", " ", "NumPeriods"}], " ", 
            "&&", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"BalanceSheetFirms", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], ">", " ", "0"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"PriceHistory", "[", 
              RowBox[{"[", 
               RowBox[{"CurrentPeriod", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"PriceHistory", "[", 
               RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", "PriceUpAdjustment"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Decrease", " ", "with", " ", "high", " ", "inventory"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"BalanceSheetFirms", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], " ", ">", " ", 
              "InventoryLevelTarget"}], ")"}], " ", "&&", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"PriceHistory", "[", 
                RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ">", "PriceMinimum"}], " ", 
             ")"}], "&&", " ", 
            RowBox[{
            "CurrentPeriod", " ", "\[NotEqual]", " ", "NumPeriods"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"PriceHistory", "[", 
              RowBox[{"[", 
               RowBox[{"CurrentPeriod", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"PriceHistory", "[", 
               RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             "PriceDownAdjustment"}]}]}], "\[IndentingNewLine]", "]"}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Banks", " ", "pay", " ", "out", " ", "interest", " ", "on", " ", 
        RowBox[{"deposits", " ", "--"}], " ", "currently", " ", "breaks", " ",
         "SF", " ", "consistency", " ", 
        RowBox[{"(", 
         RowBox[{
         "or", " ", "is", " ", "just", " ", "a", " ", "central", " ", 
          "bank"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"BalanceSheetHouseholds", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", "*=", " ", "RiskFreeRate"}], 
         ";"}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Increase", " ", "amount", " ", "deposited", " ", "for", " ", "each",
           " ", "household"}], " ", "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumHouseholds"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BalanceSheetBanks", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "*=", " ", "RiskFreeRate"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"Increase", " ", 
        RowBox[{"bank", "'"}], "s", " ", "cash"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BalanceSheetBanks", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "*=", " ", "RiskFreeRate"}], ";",
       " ", 
      RowBox[{"(*", " ", 
       RowBox[{"And", " ", 
        RowBox[{"bank", "'"}], "s", " ", "liabilities"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Record", " ", "macroeconomic", " ", "statistics"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MacroeconomicOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "CurrentPeriod"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MacroeconomicOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"RevenueSummary", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", "Output", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MacroeconomicOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"RevenueSummary", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", " ", 
        RowBox[{"N", "[", 
         RowBox[{"Mean", "[", 
          RowBox[{"PriceHistory", "[", 
           RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Nominal", " ", "GDP"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MacroeconomicOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"RevenueSummary", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", "Inventory", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MacroeconomicOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", "ConsumptionTracker"}],
       ";", " ", 
      RowBox[{"(*", " ", "Consumption", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MacroeconomicOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"NumHouseholds", "-", "Employment"}], ")"}], "/", 
         "NumHouseholds"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", "Unemployment", " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Record", " ", "labor", " ", "market", " ", "statistics"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LaborOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "CurrentPeriod"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LaborOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "Employment"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LaborOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"NumHouseholds", "-", "Employment"}], ")"}], "/", 
         "NumHouseholds"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", "Unemployment", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LaborOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{"Mean", "[", 
         RowBox[{"BalanceSheetHouseholds", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "6"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LaborOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", "PriceLabor"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Record", " ", "business", " ", "statistics"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BusinessOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "CurrentPeriod"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BusinessOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{"Mean", "[", 
         RowBox[{"PriceHistory", "[", 
          RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "]"}], "]"}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Average", " ", "price", " ", "of", " ", "goods", " ", "in", " ", 
        "economy"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"BusinessOutput", "[", 
         RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{"Mean", "[", 
         RowBox[{"ProductionMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "10"}], "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Average", " ", "Expected", " ", "Profit"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Record", " ", "distribution", " ", "of", " ", "firms"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FirmDistribution", "[", 
           RowBox[{"[", "CurrentPeriod", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"RevenueMatrix", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}], "&&", 
            RowBox[{
             RowBox[{"RevenueSummary", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"RevenueMatrix", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/", 
            RowBox[{"RevenueSummary", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Reset", " ", "per"}], "-", 
        RowBox[{"period", " ", "matrices"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ProductionMatrix", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"NumFirms", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RevenueMatrix", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"NumFirms", ",", "5"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Set", " ", "inventory", " ", "in", " ", "the", " ", "revenue", " ", 
        "matrix", " ", "to", " ", "be", " ", "peristent", " ", "across", " ", 
        "periods"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"RevenueMatrix", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"BalanceSheetFirms", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], "*", "InventorySpoilage"}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumFirms"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Reset", " ", "employment", " ", "status"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BalanceSheetHouseholds", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NumHouseholds"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "BalanceSheetFirms", ",", "MacroeconomicOutput", ",", "LaborOutput", 
        ",", "BusinessOutput"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719577005983593*^9, 3.7195770231271887`*^9}, {
   3.719577778854082*^9, 3.719577900027*^9}, {3.719577932307274*^9, 
   3.719578109100601*^9}, {3.719578163212306*^9, 3.7195782641380577`*^9}, {
   3.719578295698763*^9, 3.71957829816607*^9}, {3.719578651120509*^9, 
   3.719578651248187*^9}, {3.719584780651713*^9, 3.719584819698082*^9}, {
   3.719584936069303*^9, 3.7195849391834106`*^9}, {3.719585339961439*^9, 
   3.719585373024518*^9}, {3.719668946064857*^9, 3.719668987233123*^9}, {
   3.7196691405033197`*^9, 3.719669182358683*^9}, {3.7196692181841707`*^9, 
   3.7196692536365547`*^9}, {3.719669294482525*^9, 3.7196692969772243`*^9}, {
   3.7196693594105*^9, 3.719669364986415*^9}, {3.719669422670783*^9, 
   3.719669426989263*^9}, {3.719669474186893*^9, 3.719669487882112*^9}, {
   3.7196696286441*^9, 3.719669631515511*^9}, {3.719671627389683*^9, 
   3.7196716274849453`*^9}, {3.719679053202771*^9, 3.719679067416327*^9}, {
   3.719679107517091*^9, 3.719679118021245*^9}, {3.719845120069716*^9, 
   3.7198451313954573`*^9}, {3.719845517174011*^9, 3.719845525676743*^9}, {
   3.721402748969817*^9, 3.721402749436391*^9}, {3.721425189875786*^9, 
   3.721425196212268*^9}, {3.721583161128544*^9, 3.721583161767099*^9}, 
   3.721747937556294*^9, {3.7217480355932493`*^9, 3.721748043800042*^9}, {
   3.721756713954777*^9, 3.721756775748781*^9}, {3.721757031321561*^9, 
   3.721757123553487*^9}, {3.7217573223695917`*^9, 3.7217573536580763`*^9}, {
   3.751144726591414*^9, 3.751144769494787*^9}, {3.7511921561425037`*^9, 
   3.751192161141563*^9}, {3.751192315661322*^9, 3.7511923158659353`*^9}, {
   3.751192605898563*^9, 3.7511926334532347`*^9}, {3.7511930869526453`*^9, 
   3.7511931091919737`*^9}, {3.7511931691055393`*^9, 3.751193215228256*^9}, {
   3.7511932550227003`*^9, 3.751193294968995*^9}, {3.751193406977005*^9, 
   3.751193462970017*^9}, {3.751198367987639*^9, 3.751198415530336*^9}, {
   3.7511985384973097`*^9, 3.751198551647254*^9}, {3.7511986252816353`*^9, 
   3.751198674721776*^9}, {3.751198992468948*^9, 3.751198993467053*^9}, {
   3.751200164253374*^9, 3.75120017364115*^9}, 3.751200462249612*^9, {
   3.751200621879759*^9, 3.7512006238536673`*^9}, {3.75120559948405*^9, 
   3.7512056072497587`*^9}, 3.751274860796586*^9, {3.751285010936985*^9, 
   3.751285027038947*^9}, {3.751285142251069*^9, 3.751285169450869*^9}, 
   3.751285282720879*^9, {3.75128561404832*^9, 3.751285615055914*^9}, {
   3.751285777702279*^9, 3.751285806821624*^9}, {3.751285896849888*^9, 
   3.7512859000718412`*^9}, {3.751286038164658*^9, 3.7512860565989532`*^9}, 
   3.751286117568191*^9, {3.7512871585645638`*^9, 3.751287187515346*^9}, {
   3.751287315528213*^9, 3.7512873452552967`*^9}, {3.751287611872457*^9, 
   3.751287629389645*^9}, {3.751287714304461*^9, 3.7512877222636013`*^9}, {
   3.7512879643119497`*^9, 3.751288016232121*^9}, 3.751288092132595*^9, {
   3.7512881244768972`*^9, 3.751288134858871*^9}, {3.7512882650244703`*^9, 
   3.75128831475272*^9}, {3.751288482637315*^9, 3.751288520165346*^9}, {
   3.7512887525736*^9, 3.751288778388276*^9}, {3.7512891652451677`*^9, 
   3.7512892051042833`*^9}, {3.751289275164668*^9, 3.7512892810981503`*^9}, {
   3.7512896230772123`*^9, 3.751289686670232*^9}, {3.751289720136238*^9, 
   3.7512897385588837`*^9}, {3.751289896653352*^9, 3.751289949020988*^9}, {
   3.751291544022601*^9, 3.751291544771619*^9}, 3.751291589956357*^9, {
   3.751291672781856*^9, 3.75129167478128*^9}, {3.7512917091044683`*^9, 
   3.75129179263237*^9}, {3.751292144363853*^9, 3.7512921580502377`*^9}, {
   3.751292236340785*^9, 3.7512922371484203`*^9}, {3.75129230322371*^9, 
   3.751292303638953*^9}, {3.7512923495381327`*^9, 3.751292372136896*^9}, {
   3.751292463069175*^9, 3.7512925196561413`*^9}, {3.7512925915568457`*^9, 
   3.751292613450962*^9}, {3.7512927934266167`*^9, 3.7512927935692253`*^9}, 
   3.7512946989600286`*^9, {3.751297197546061*^9, 3.751297241042027*^9}, {
   3.75131162058737*^9, 3.7513116233621893`*^9}, {3.751311672662122*^9, 
   3.751311689052218*^9}, {3.751312804092746*^9, 3.7513128061609898`*^9}, {
   3.75131292239585*^9, 3.751312933175996*^9}, {3.751313604819078*^9, 
   3.7513136085770273`*^9}, {3.751314105751857*^9, 3.751314105866128*^9}, {
   3.751314228261194*^9, 3.751314242420686*^9}, {3.751314465390513*^9, 
   3.751314525808015*^9}, {3.751314677967186*^9, 3.7513147563865137`*^9}, {
   3.7513148596492577`*^9, 3.7513148645272217`*^9}, {3.751319591426371*^9, 
   3.751319608920538*^9}, 3.751319717132099*^9, {3.7513214367783318`*^9, 
   3.751321446439801*^9}, {3.751321788164626*^9, 3.7513218363859043`*^9}, {
   3.75132302026448*^9, 3.751323060429669*^9}, {3.751323300149579*^9, 
   3.751323308268008*^9}, 3.751323353373348*^9, {3.751323390421801*^9, 
   3.751323404567705*^9}, {3.751323451905328*^9, 3.751323476720984*^9}, {
   3.7513235145967484`*^9, 3.751323516508574*^9}, {3.751323588213441*^9, 
   3.751323692844479*^9}, {3.751323745366836*^9, 3.75132375280048*^9}, {
   3.751324093650484*^9, 3.751324144389043*^9}, {3.751324196521997*^9, 
   3.751324197671357*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Run", " ", "the", " ", "Economy"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentPeriod", "=", "k"}], ";", "\[IndentingNewLine]", 
      "ProductionAllocation", ";", "\[IndentingNewLine]", "PurchaseCapital", 
      ";", "\[IndentingNewLine]", "LaborSearch", ";", "\[IndentingNewLine]", 
      "FirmsProduce", ";", "\[IndentingNewLine]", "ConsumptionMarket", ";", 
      "\[IndentingNewLine]", "Bookkeeping", ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Period \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "CurrentPeriod", "]"}], " ", "<>", " ", 
        "\"\< complete.\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "NumPeriods"}], "}"}]}], "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.719614996958913*^9, 3.7196150122478247`*^9}, {
   3.719615207724676*^9, 3.7196152503406982`*^9}, {3.719615357485282*^9, 
   3.7196153589130373`*^9}, 3.7196829416776533`*^9, 3.719684340242147*^9, 
   3.719767961191832*^9, {3.719838780660274*^9, 3.719838782933826*^9}, {
   3.721401532342826*^9, 3.7214015382494793`*^9}, {3.721401659644986*^9, 
   3.721401662544051*^9}, {3.721583610674404*^9, 3.721583611064343*^9}, 
   3.7511289923322697`*^9, 3.751129299042309*^9, {3.751141493165678*^9, 
   3.751141498804658*^9}, {3.7511415831907253`*^9, 3.751141618354025*^9}, {
   3.751142681989925*^9, 3.7511426822274733`*^9}, {3.75114313924426*^9, 
   3.7511431396518517`*^9}, {3.751143808154202*^9, 3.751143809033348*^9}, {
   3.751143920547083*^9, 3.751143925114753*^9}, {3.751143963029933*^9, 
   3.751143963892416*^9}, {3.751143996656887*^9, 3.751143997120767*^9}, {
   3.75129936658575*^9, 3.751299383480473*^9}, {3.751301178027771*^9, 
   3.751301178411162*^9}, {3.751301692056971*^9, 3.751301696655059*^9}, {
   3.751301913279272*^9, 3.751301929925375*^9}, {3.751312541115883*^9, 
   3.751312541585742*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "PrintMacroeconomicOutput", "\[IndentingNewLine]", "PrintLaborOutput", 
   "\[IndentingNewLine]", "PrintBusinessOutput"}], "*)"}]], "Input",
 CellChangeTimes->{{3.719838789555848*^9, 3.71983879495821*^9}, 
   3.721669164833929*^9, 3.721671141813307*^9, 3.751314150753951*^9, {
   3.751314876999014*^9, 3.751314887796067*^9}, {3.751323555759034*^9, 
   3.751323570597918*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlotOutput", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"MacroeconomicOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Output\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotnGDP", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"MacroeconomicOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<nGDP\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotInventory", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"MacroeconomicOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Unsold Inventory\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotConsumption", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"MacroeconomicOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Consumption\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotUnemployment", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"MacroeconomicOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "6"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Unemployment\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotWagePrice", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LaborOutput", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"LaborOutput", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Reservation vs Paid Wage\>\""}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotPrices", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"BusinessOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Prices\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotExpProfit", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"BusinessOutput", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Average Expected Profit\>\""}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotFirmDistribution", " ", "=", " ", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "FirmDistribution", "]"}], ",", 
     RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", "\"\<Distribution of Firm Production\>\""}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7512928520174093`*^9, 3.751292864359848*^9}, {
   3.751292896745955*^9, 3.751292899248715*^9}, {3.751293032135208*^9, 
   3.751293041148995*^9}, {3.7512946455043783`*^9, 3.751294673697513*^9}, {
   3.751294713812066*^9, 3.7512948295888777`*^9}, {3.751295328895797*^9, 
   3.751295334675646*^9}, {3.751295782136726*^9, 3.7512958323523903`*^9}, {
   3.751295913131521*^9, 3.7512959557004633`*^9}, {3.751296004839487*^9, 
   3.7512960541439962`*^9}, {3.751296534333275*^9, 3.7512965412833567`*^9}, {
   3.751312210071953*^9, 3.7513122220341*^9}, {3.751314105673715*^9, 
   3.751314105713418*^9}, 3.751314896066483*^9, {3.75131503060297*^9, 
   3.751315072805791*^9}, {3.751323720736978*^9, 3.751323728024518*^9}, {
   3.7513237602903547`*^9, 3.75132381127385*^9}, {3.751323845034935*^9, 
   3.751323848107513*^9}, {3.75132390261691*^9, 3.751323903230835*^9}, {
   3.751323993267766*^9, 3.751323996769927*^9}, 3.75132404407873*^9}],

Cell[BoxData[
 RowBox[{"GraphicsGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PlotOutput", ",", "PlotnGDP", ",", "PlotConsumption"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "PlotInventory", ",", "PlotUnemployment", ",", "PlotWagePrice"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
      "PlotPrices", ",", "PlotExpProfit", ",", "PlotFirmDistribution"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7512928520174093`*^9, 3.751292864359848*^9}, {
   3.751292896745955*^9, 3.751292899248715*^9}, {3.751293032135208*^9, 
   3.751293041148995*^9}, {3.7512946455043783`*^9, 3.751294673697513*^9}, {
   3.751294713812066*^9, 3.7512948295888777`*^9}, {3.751295328895797*^9, 
   3.751295334675646*^9}, {3.751295782136726*^9, 3.7512958323523903`*^9}, {
   3.751295913131521*^9, 3.7512959557004633`*^9}, {3.751296004839487*^9, 
   3.7512960541439962`*^9}, {3.751296096456461*^9, 3.751296108788273*^9}, {
   3.7512963967808657`*^9, 3.7512964066396427`*^9}, 3.7513149007850523`*^9, {
   3.7513150781177797`*^9, 3.751315079276455*^9}, {3.751323819939657*^9, 
   3.751323839362445*^9}, 3.751323944042145*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Run", " ", "the", " ", "economy", " ", "manually"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CurrentPeriod", " ", "=", " ", "2"}], ";", "\[IndentingNewLine]",
     "ProductionAllocation", ";", "\[IndentingNewLine]", "PurchaseCapital", 
    ";", "\[IndentingNewLine]", "LaborSearch", ";", "\[IndentingNewLine]", 
    "FirmsProduce", ";", "\[IndentingNewLine]", "ConsumptionMarket", ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7185848018755817`*^9, 3.7185848126571827`*^9}, {
   3.718584860593587*^9, 3.718584861155942*^9}, {3.718585538681419*^9, 
   3.718585605256465*^9}, {3.718585667651392*^9, 3.7185856720430403`*^9}, {
   3.718629469557502*^9, 3.718629483364459*^9}, {3.7186405809889936`*^9, 
   3.71864061243532*^9}, {3.718641179524047*^9, 3.718641201251574*^9}, {
   3.718641866868531*^9, 3.718641915887043*^9}, {3.718643022340992*^9, 
   3.718643026542817*^9}, 3.719576978405661*^9, {3.719577728166718*^9, 
   3.71957773009429*^9}, {3.719578269951619*^9, 3.719578280469755*^9}, {
   3.7195786170966377`*^9, 3.719578619878428*^9}, {3.719578723502593*^9, 
   3.719578780062972*^9}, 3.719578835609192*^9, {3.719578991876474*^9, 
   3.719578992642108*^9}, {3.719584871684688*^9, 3.7195849145303507`*^9}, {
   3.7195850636472063`*^9, 3.719585081239195*^9}, {3.719585115300014*^9, 
   3.7195851825874043`*^9}, {3.719585248368437*^9, 3.719585248455879*^9}, {
   3.7195859188121853`*^9, 3.719585918889965*^9}, {3.719586034195787*^9, 
   3.719586036864546*^9}, 3.719612467582912*^9, {3.719612607544738*^9, 
   3.719612607663883*^9}, {3.719614702845108*^9, 3.7196147035581408`*^9}, {
   3.719614929390971*^9, 3.719614932468099*^9}, 3.7196152899363422`*^9, {
   3.719670841363257*^9, 3.7196708745970783`*^9}, {3.7196756425392637`*^9, 
   3.7196756426656847`*^9}, {3.719675946138421*^9, 3.719675965736115*^9}, {
   3.719680273962471*^9, 3.719680281347288*^9}, {3.7196803319839907`*^9, 
   3.719680356984213*^9}, 3.719680517120235*^9, {3.719682944956358*^9, 
   3.719682962165575*^9}, {3.7196830075003977`*^9, 3.719683008291798*^9}, {
   3.7196832623059072`*^9, 3.7196832720151997`*^9}, 3.719684320547161*^9, {
   3.719767955340026*^9, 3.7197679956819487`*^9}, {3.7197680502072353`*^9, 
   3.719768060839348*^9}, {3.7197682129368067`*^9, 3.719768213016266*^9}, {
   3.719768245684413*^9, 3.719768245730529*^9}, {3.719768381453265*^9, 
   3.719768381506054*^9}, {3.7197684145395803`*^9, 3.719768478865584*^9}, {
   3.7197691621500187`*^9, 3.719769162228129*^9}, {3.719769401494913*^9, 
   3.719769401902172*^9}, {3.719769583141767*^9, 3.7197695983239*^9}, {
   3.719769804415783*^9, 3.719769804454611*^9}, 3.719769871262093*^9, {
   3.719769902712351*^9, 3.7197699027985277`*^9}, {3.7197699962451553`*^9, 
   3.719769996306533*^9}, {3.719770163861899*^9, 3.719770185520917*^9}, {
   3.719770259388714*^9, 3.719770259466729*^9}, {3.719771480569953*^9, 
   3.719771481256343*^9}, {3.719771627703497*^9, 3.7197716281975393`*^9}, {
   3.7197717510701838`*^9, 3.719771751730785*^9}, {3.719771782493022*^9, 
   3.7197717831148853`*^9}, {3.719837801722649*^9, 3.719837801880962*^9}, 
   3.719837849052692*^9, {3.719838405031625*^9, 3.719838405157456*^9}, {
   3.719838643517294*^9, 3.71983864360299*^9}, {3.719838693485632*^9, 
   3.7198386940834417`*^9}, {3.71983874800704*^9, 3.719838768635192*^9}, {
   3.751143814130343*^9, 3.751143820936953*^9}, 3.751144033782199*^9, {
   3.751144167496237*^9, 3.7511441680948133`*^9}, 3.751192061343193*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Bookkeeping", ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7197695919736*^9, 3.719769595267911*^9}, {
   3.7197699921155863`*^9, 3.719769993858879*^9}, 3.719771622465498*^9, {
   3.719771739548074*^9, 3.7197717431624002`*^9}, 3.719838760414833*^9, 
   3.751144038685308*^9, 3.751192056885229*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "PrintBanks", "\[IndentingNewLine]", "PrintFirms", "\[IndentingNewLine]", 
   "PrintRevenue", "\[IndentingNewLine]", "PrintProduction", 
   "\[IndentingNewLine]", "PrintMacroeconomicOutput", "\[IndentingNewLine]", 
   "PrintHouseholds"}], "*)"}]], "Input",
 CellChangeTimes->{3.719615285468631*^9, 3.719670861155211*^9, 
  3.719675929110269*^9, 3.719680285762088*^9, 3.719680523397649*^9, 
  3.719682950936082*^9, 3.719684325606114*^9, 3.7197679507228193`*^9, 
  3.7198387541885147`*^9, 3.751144041627536*^9, 3.751192050927227*^9, 
  3.7513141507707157`*^9}]
},
WindowSize->{1280, 756},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 19606, 402, 1199, "Input"],
Cell[20167, 424, 201, 5, 33, "Input"],
Cell[20371, 431, 2718, 65, 199, "Input"],
Cell[23092, 498, 1310, 38, 80, "Input"],
Cell[24405, 538, 2327, 52, 148, "Input"],
Cell[26735, 592, 1653, 39, 114, "Input"],
Cell[28391, 633, 1332, 35, 80, "Input"],
Cell[29726, 670, 3575, 81, 216, "Input"],
Cell[33304, 753, 197, 5, 33, "Input"],
Cell[33504, 760, 12362, 278, 624, "Input"],
Cell[45869, 1040, 1601, 40, 80, "Input"],
Cell[47473, 1082, 23672, 486, 1280, "Input"],
Cell[71148, 1570, 3493, 76, 131, "Input"],
Cell[74644, 1648, 18642, 371, 981, "Input"],
Cell[93289, 2021, 22972, 505, 1202, "Input"],
Cell[116264, 2528, 2053, 36, 199, "Input"],
Cell[118320, 2566, 418, 8, 63, "Input"],
Cell[118741, 2576, 4574, 107, 165, "Input"],
Cell[123318, 2685, 1237, 26, 46, "Input"],
Cell[124558, 2713, 3541, 52, 131, "Input"],
Cell[128102, 2767, 339, 6, 28, "Input"],
Cell[128444, 2775, 601, 11, 114, "Input"]
}
]
*)

(* End of internal cache information *)
